<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>{% if patient %}编辑{% else %}添加{% endif %}病人</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">

<div class="container">
    <h2 class="mb-4">{% if patient %}编辑{% else %}添加{% endif %}病人</h2>
    <form method="POST">
        <div class="mb-3">
            <label class="form-label">病人编号</label>
            <input type="text" name="patient_id" class="form-control" value="{{ patient.patient_id if patient else '' }}" {% if patient %}readonly{% endif %} required>
        </div>
        <div class="mb-3">
            <label class="form-label">姓名</label>
            <input type="text" name="name" class="form-control" value="{{ patient.name if patient else '' }}" required>
        </div>
        <div class="mb-3">
            <label class="form-label">年龄</label>
            <input type="number" name="age" class="form-control" value="{{ patient.age if patient else '' }}" required>
        </div>
        <div class="mb-3">
            <label class="form-label">性别</label>
            <select name="sex" class="form-select" required>
                <option value="男" {% if patient and patient.sex == '男' %}selected{% endif %}>男</option>
                <option value="女" {% if patient and patient.sex == '女' %}selected{% endif %}>女</option>
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">负责医生</label>
            <select name="doctor_id" class="form-select">
                {% for doctor in doctors %}
                <option value="{{ doctor.doctor_id }}" {% if patient and patient.doctor_id == doctor.doctor_id %}selected{% endif %}>
                    {{ doctor.name }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">所在病房</label>
            <select name="room_id" class="form-select">
                {% for room in rooms %}
                <option value="{{ room.room_id }}" {% if patient and patient.room_id == room.room_id %}selected{% endif %}>
                    {{ room.room_id }}
                </option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-success">{% if patient %}更新{% else %}添加{% endif %}</button>
        <a class="btn btn-secondary" href="{{ url_for('patient_bp.list_patients') }}">取消</a>
    </form>
</div>
</body>
</html>
